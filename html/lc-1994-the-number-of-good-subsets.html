<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>LC 1994. 好子集的数目</title>
<meta name="author" content="dirtysalt" />
<meta name="generator" content="Org Mode" />
<link rel="shortcut icon" href="/themes/favicon.ico" /><link rel="stylesheet" type="text/css" href="/themes/simple.css"/></head>
<body>
<div id="content" class="content">
<h1 class="title">LC 1994. 好子集的数目</h1>
<p>
<a href="https://leetcode-cn.com/problems/the-number-of-good-subsets/">https://leetcode-cn.com/problems/the-number-of-good-subsets/</a>
</p>

<p>
这题的nums的数量非常多，但是范围却非常小，所以从范围入手是个好主意，对于重复出现的数字其实性质是一样的。
</p>

<p>
从1-30范围内的素数以及符合基本条件的数字也就是下面这么多
</p>

<ul class="org-ul">
<li>primes = [2, 3, 5, 7, 11, 13, 17, 19, 23, 29]</li>
<li>good_numbers = [2, 3, 5, 6, 7, 10, 11, 13, 14, 15, 17, 19, 21, 22, 23, 26, 29, 30] # size = 18</li>
</ul>

<p>
我们可以把每个 good_numbers 里面的数字挂在对应的素数下面，那么这个组合的情况其实不多。
</p>

<p>
实现中还有个问题要考虑的是，比如15如果挂在了3下面就不要挂在5下面，不然在选择的时候会出现
</p>
<ul class="org-ul">
<li>在3下面选择15，在5下面不选择</li>
<li>在3下面不选择，在5下面选择15</li>
</ul>
<p>
出现重复计算的情况，所以我们选择某一个prime进行挂载就好了。
</p>

<p>
还可能出现个问题是，比如对于7和14，如果14挂在了2下面，而7挂在了7下面，他们之间还是可能有公约数的情况，所以在搜索的时候，
我们可能还是需要判断，选择某个数是否和之前的选择数是互质的。因为范围比较小，所以这个gcd可以预先打表计算出来。
</p>

<p>
最后我们要把1排除在外，对于每个1有选择或者是不选择两种情况，所以结果需要乘以 `1&lt;&lt;(cnt[1])`
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-py-def-class">class</span> <span class="org-py-class-name">Solution</span>:
    <span class="org-py-def-class">def</span> <span class="org-function-name">numberOfGoodSubsets</span>(<span class="org-py-object-reference">self</span>, nums: List[<span class="org-py-builtins">int</span>]) -&gt; <span class="org-py-builtins">int</span>:
        <span class="org-py-variable-name">primes</span> = [<span class="org-py-number">2</span>, <span class="org-py-number">3</span>, <span class="org-py-number">5</span>, <span class="org-py-number">7</span>, <span class="org-py-number">11</span>, <span class="org-py-number">13</span>, <span class="org-py-number">17</span>, <span class="org-py-number">19</span>, <span class="org-py-number">23</span>, <span class="org-py-number">29</span>]
        <span class="org-py-variable-name">good_numbers</span> = [<span class="org-py-number">2</span>, <span class="org-py-number">3</span>, <span class="org-py-number">5</span>, <span class="org-py-number">6</span>, <span class="org-py-number">7</span>, <span class="org-py-number">10</span>, <span class="org-py-number">11</span>, <span class="org-py-number">13</span>, <span class="org-py-number">14</span>, <span class="org-py-number">15</span>, <span class="org-py-number">17</span>, <span class="org-py-number">19</span>, <span class="org-py-number">21</span>, <span class="org-py-number">22</span>, <span class="org-py-number">23</span>, <span class="org-py-number">26</span>, <span class="org-py-number">29</span>, <span class="org-py-number">30</span>]
        <span class="org-py-variable-name">coprimes</span> = <span class="org-py-builtins">set</span>()

        <span class="org-py-def-class">def</span> <span class="org-function-name">gcd</span>(x, y):
            <span class="org-keyword">while</span> y != <span class="org-py-number">0</span>:
                <span class="org-py-variable-name">x</span>, <span class="org-py-variable-name">y</span> = y, x % y
            <span class="org-keyword">return</span> x

        <span class="org-keyword">for</span> x <span class="org-keyword">in</span> <span class="org-py-builtins">range</span>(<span class="org-py-number">1</span>, <span class="org-py-number">31</span>):
            <span class="org-keyword">for</span> y <span class="org-keyword">in</span> <span class="org-py-builtins">range</span>(<span class="org-py-number">1</span>, <span class="org-py-number">31</span>):
                <span class="org-keyword">if</span> gcd(x, y) == <span class="org-py-number">1</span>:
                    coprimes.add((x, y))

        <span class="org-py-variable-name">cnt</span> = [<span class="org-py-number">0</span>] * <span class="org-py-number">31</span>
        <span class="org-keyword">for</span> x <span class="org-keyword">in</span> nums:
            <span class="org-py-variable-name">cnt</span>[x] += <span class="org-py-number">1</span>

        <span class="org-py-variable-name">counters</span> = []
        <span class="org-keyword">for</span> p <span class="org-keyword">in</span> primes:
            <span class="org-py-variable-name">tmp</span> = []
            <span class="org-keyword">for</span> x <span class="org-keyword">in</span> good_numbers:
                <span class="org-keyword">if</span> x % <span class="org-py-variable-name">p</span> == <span class="org-py-number">0</span> <span class="org-keyword">and</span> cnt[x] != <span class="org-py-number">0</span>:
                    tmp.append((x, cnt[x]))
                    <span class="org-py-variable-name">cnt</span>[x] = <span class="org-py-number">0</span>  <span class="org-comment"># not select anymore</span>
            counters.append(tmp)

        <span class="org-py-def-class">def</span> <span class="org-function-name">dfs</span>(k, select):
            <span class="org-keyword">if</span> <span class="org-py-variable-name">k</span> == <span class="org-py-builtins">len</span>(primes):
                <span class="org-keyword">return</span> <span class="org-py-number">1</span>

            <span class="org-py-variable-name">res</span> = dfs(k + <span class="org-py-number">1</span>, select)
            <span class="org-keyword">for</span> x, c <span class="org-keyword">in</span> counters[k]:
                <span class="org-py-variable-name">ok</span> = <span class="org-py-pseudo-keyword">True</span>
                <span class="org-comment"># for p in select:</span>
                <span class="org-comment">#     if (x, p) not in coprimes:</span>
                <span class="org-comment">#         ok = False</span>
                <span class="org-comment">#         break</span>

                <span class="org-keyword">if</span> ok:
                    select.append(x)
                    <span class="org-py-variable-name">res</span> += c * dfs(k + <span class="org-py-number">1</span>, select)
                    select.pop()

            <span class="org-keyword">return</span> res

        <span class="org-comment"># print(counters)</span>

        <span class="org-comment"># including empty set.</span>
        <span class="org-py-variable-name">ans</span> = dfs(<span class="org-py-number">0</span>, []) - <span class="org-py-number">1</span>
        <span class="org-py-variable-name">ans</span> *= (<span class="org-py-number">1</span> &lt;&lt; cnt[<span class="org-py-number">1</span>])

        <span class="org-py-variable-name">MOD</span> = <span class="org-py-number">10</span> ** <span class="org-py-number">9</span> + <span class="org-py-number">7</span>
        <span class="org-keyword">return</span> ans % MOD
</pre>
</div>
</div>
<div id="content"><!-- DISQUS BEGIN --><div id="disqus_thread"></div><script>/***  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/var disqus_config = function () {this.page.url = 'https://dirtysalt.github.io/html/lc-1994-the-number-of-good-subsets.html';this.page.identifier = 'lc-1994-the-number-of-good-subsets.html';};(function() {var d = document, s = d.createElement('script');s.src = 'https://dirlt.disqus.com/embed.js';s.setAttribute('data-timestamp', +new Date());(d.head || d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><!-- DISQUS END --></div></body>
</html>
