<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>回顾2019</title>
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="dirtysalt" />
<link rel="shortcut icon" href="/themes/favicon.ico" /><link rel="stylesheet" type="text/css" href="/themes/simple.css"/></head>
<body>
<div id="content">
<h1 class="title">回顾2019</h1>
<p>
@2020-11
</p>

<p>
这篇回顾写的有点晚了。我接着上一篇继续往下写，把现在还记得的事情记录下来。
</p>

<p>
之后就决定继续待在公司，把该做的事情做好。回去之后重构了系统中很多代码，并且将许多耦合在一起的代码开始拆分成为多个服务。
</p>

<p>
现在来看，我对这个重构接口还是非常满意的，接口比原来清晰了许多。除了应用代码之外还：
</p>
<ul class="org-ul">
<li>增加系统内部指标，用来监控和报告系统健康程度
</li>
<li>通过pass rpcId方式来trace跨服务调用
</li>
<li>封装flask框架支持google protocol rpc调用
</li>
<li>提供了worker/webapp两类应用的注册服务代码
</li>
<li>实现了一个KVClient(mongodb + redis cache)
</li>
<li>将数据分析从adhoc代码全部迁移到了aws athena上
</li>
</ul>

<p>
比较遗憾的是没有太接触docker/k8s/fargate这种容器服务，原本是想将所有的服务都做成容器化，这样伸缩性就可以做的很好，对于节省成本来说是非常有帮助的。不过在大体调研之后，发现有几个问题不太适合使用这种容器服务：
</p>
<ol class="org-ol">
<li>容器化服务会复杂上线流程。这个可能和开发模式有关系，我们team开发方式是比较粗狂的。
</li>
<li>这个和1也有关系，就是我们在服务打包没有太多经验。比如打包我们肯定不能只打包自己的代码，还需要将类似filebeat(收集日志)这种外部应用程序打包进去。另外我们需要额外的机器用于打包和发布。
</li>
<li>对这种容器服务的成本和复杂性的担心，除非肯花时间和钱做实验，否则我们一旦迁过去如果不满意再回来，就会很痛苦。
</li>
<li>我们应用本身就有许多不能伸缩的服务，比如mongodb, redis, es, 这些是成本的大头。web这种可伸缩的资源比例不大。
</li>
</ol>
<p>
我隐隐地觉得，容器化服务这种东西，只有特大规模的公司才会使用，甚至中型公司使用它都会是个灾难（除非它的业务本身伸缩性就特别强）。
</p>

<p>
觉得既然在这家公司要好好做，和老婆就商量还是北京天津两边跑。老婆觉得整天在单位也挺压抑的，趁现在还不算太晚，再要一个。这样一方面qiqi就有弟弟陪伴，另一方面自己这两年也可以把心思放在家上面。为了配合属相，这个宝宝必须在今年底生下来，所以尝试到4月份。如果4月份还没有怀孕的话，那么就不生了。谁知道，还真就中了。
</p>

<p>
知道怀上了之后，最担心的事情就是孩子的健康，赶紧去中心妇产预约了一个NT（这个NT非常紧俏，必须在刚出生就去预约，否则是排不上号的）。到了30个月左右的时候就需要建本，选择在哪个医院生产。最开始想在和睦家生，交了钱之后，觉得和睦家那边很可能会剖腹产，所以最后还是改到了中心妇产。宝宝出生的过程可以看 <a href="have-a-baby2.html">这里</a>.
</p>

<p>
年底回了趟老家，参加父亲的60大寿。那个时候covid19已经开始蔓延了，从天津飞回家的时候我还没有太注意，老婆好心地给我准备了几个简易的口罩。事实上这些口罩非常有用，到了老家的药店，根本就买不上口罩了。
</p>

<p>
这年还有一个重要的事情，就是我开始收听喜马拉雅上的《临高启明》了。
</p>
</div>
</body>
</html>
