<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>{Ask HN}What's the largest amount of bad code you have ever seen work?</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="dirtysalt" />
<link rel="shortcut icon" href="/themes/favicon.ico" /><link rel="stylesheet" type="text/css" href="/themes/simple.css"/></head>
<body>
<div id="content">
<h1 class="title">{Ask HN}What's the largest amount of bad code you have ever seen work?</h1>
<p>
<a href="https://news.ycombinator.com/item?id=18442637">https://news.ycombinator.com/item?id=18442637</a>
</p>


<p>
Oracle Database 12.2.
</p>

<p>
It is close to 25 million lines of C code.
</p>

<p>
What an unimaginable horror! You can't change a single line of code in the product without breaking 1000s of existing tests. Generations of programmers have worked on that code under difficult deadlines and filled the code with all kinds of crap.
</p>

<p>
Very complex pieces of logic, memory management, context switching, etc. are all held together with thousands of flags. The whole code is ridden with mysterious macros that one cannot decipher without picking a notebook and expanding relevant pats of the macros by hand. It can take a day to two days to really understand what a macro does.
</p>

<p>
Sometimes one needs to understand the values and the effects of 20 different flag to predict how the code would behave in different situations. Sometimes 100s too! I am not exaggerating.
</p>

<p>
The only reason why this product is still surviving and still works is due to literally millions of tests!
</p>

<p>
Here is how the life of an Oracle Database developer is:
</p>

<ul class="org-ul">
<li>Start working on a new bug.</li>

<li>Spend two weeks trying to understand the 20 different flags that interact in mysterious ways to cause this bag.</li>

<li>Add one more flag to handle the new special scenario. Add a few more lines of code that checks this flag and works around the problematic situation and avoids the bug.</li>

<li>Submit the changes to a test farm consisting of about 100 to 200 servers that would compile the code, build a new Oracle DB, and run the millions of tests in a distributed fashion.</li>

<li>Go home. Come the next day and work on something else. The tests can take 20 hours to 30 hours to complete.</li>

<li>Go home. Come the next day and check your farm test results. On a good day, there would be about 100 failing tests. On a bad day, there would be about 1000 failing tests. Pick some of these tests randomly and try to understand what went wrong with your assumptions. Maybe there are some 10 more flags to consider to truly understand the nature of the bug.</li>

<li>Add a few more flags in an attempt to fix the issue. Submit the changes again for testing. Wait another 20 to 30 hours.</li>

<li>Rinse and repeat for another two weeks until you get the mysterious incantation of the combination of flags right.</li>

<li>Finally one fine day you would succeed with 0 tests failing.</li>

<li>Add a hundred more tests for your new change to ensure that the next developer who has the misfortune of touching this new piece of code never ends up breaking your fix.</li>

<li>Submit the work for one final round of testing. Then submit it for review. The review itself may take another 2 weeks to 2 months. So now move on to the next bug to work on.</li>

<li>After 2 weeks to 2 months, when everything is complete, the code would be finally merged into the main branch.</li>
</ul>

<p>
The above is a non-exaggerated description of the life of a programmer in Oracle fixing a bug. Now imagine what horror it is going to be to develop a new feature. It takes 6 months to a year (sometimes two years!) to develop a single small feature (say something like adding a new mode of authentication like support for AD authentication).
</p>

<p>
The fact that this product even works is nothing short of a miracle!
</p>

<p>
I don't work for Oracle anymore. Will never work for Oracle again!
</p>
</div>
</body>
</html>
