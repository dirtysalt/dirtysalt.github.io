<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>LC 6223. 移除子树后的二叉树高度</title>
<meta name="author" content="dirtysalt" />
<meta name="generator" content="Org Mode" />
<link rel="shortcut icon" href="/themes/favicon.ico" /><link rel="stylesheet" type="text/css" href="/themes/simple.css"/></head>
<body>
<div id="content" class="content">
<h1 class="title">LC 6223. 移除子树后的二叉树高度</h1>
<p>
<a href="https://leetcode.cn/problems/height-of-binary-tree-after-subtree-removal-queries/">https://leetcode.cn/problems/height-of-binary-tree-after-subtree-removal-queries/</a>
</p>

<p>
如果是每次现场计算，沿着修改节点向上溯源，那么最坏情况下面会出现O(n^2）的时间复杂度。正确的方式是：
</p>
<ul class="org-ul">
<li>首先进行一次预计算，得到节点左右子树的高度。</li>
<li>第二次遍历的时候，分别计算：
<ul class="org-ul">
<li>如果裁掉左子树，高度是多少？  `max(root.rh + d, h)`</li>
<li>如果裁掉右子树，高度是多少？ `max(root.lh + d, h)`</li>
</ul></li>
<li>遍历queries去结果集合里面查询。</li>
</ul>

<div class="org-src-container">
<pre class="src src-python"><span class="org-py-def-class">class</span> <span class="org-py-class-name">Solution</span>:
    <span class="org-py-def-class">def</span> <span class="org-function-name">treeQueries</span>(<span class="org-py-object-reference">self</span>, root: Optional[TreeNode], queries: List[<span class="org-py-builtins">int</span>]) -&gt; List[<span class="org-py-builtins">int</span>]:
        <span class="org-py-variable-name">index</span> = {}

        <span class="org-py-def-class">def</span> <span class="org-function-name">prepare</span>(root, p):
            <span class="org-keyword">if</span> root <span class="org-keyword">is</span> <span class="org-py-pseudo-keyword">None</span>:
                <span class="org-keyword">return</span> <span class="org-py-number">0</span>

            <span class="org-py-variable-name">index</span>[root.val] = root
            <span class="org-py-variable-name">root.parent</span> = p
            <span class="org-py-variable-name">lh</span> = prepare(root.left, root)
            <span class="org-py-variable-name">rh</span> = prepare(root.right, root)
            <span class="org-py-variable-name">root.lh</span> = lh
            <span class="org-py-variable-name">root.rh</span> = rh
            <span class="org-keyword">return</span> <span class="org-py-builtins">max</span>(lh, rh) + <span class="org-py-number">1</span>

        prepare(root, <span class="org-py-pseudo-keyword">None</span>)

        <span class="org-py-variable-name">record</span> = {}

        <span class="org-py-def-class">def</span> <span class="org-function-name">walk</span>(root, h, d):
            <span class="org-py-variable-name">l</span> = root.left
            <span class="org-keyword">if</span> l <span class="org-keyword">is</span> <span class="org-keyword">not</span> <span class="org-py-pseudo-keyword">None</span>:
                <span class="org-py-variable-name">h2</span> = <span class="org-py-builtins">max</span>(root.rh + d, h)
                <span class="org-py-variable-name">record</span>[l.val] = h2
                walk(l, h2, d + <span class="org-py-number">1</span>)
            <span class="org-py-variable-name">r</span> = root.right
            <span class="org-keyword">if</span> r <span class="org-keyword">is</span> <span class="org-keyword">not</span> <span class="org-py-pseudo-keyword">None</span>:
                <span class="org-py-variable-name">h2</span> = <span class="org-py-builtins">max</span>(root.lh + d, h)
                <span class="org-py-variable-name">record</span>[r.val] = h2
                walk(r, h2, d + <span class="org-py-number">1</span>)

        walk(root, <span class="org-py-number">0</span>, <span class="org-py-number">0</span>)

        <span class="org-py-variable-name">ans</span> = []
        <span class="org-keyword">for</span> q <span class="org-keyword">in</span> queries:
            <span class="org-py-variable-name">r</span> = record[q]
            ans.append(r)
        <span class="org-keyword">return</span> ans
</pre>
</div>
</div>
<div id="content"><!-- DISQUS BEGIN --><div id="disqus_thread"></div><script>/***  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/var disqus_config = function () {this.page.url = 'https://dirtysalt.github.io/html/lc-6223-height-of-binary-tree-after-subtree-removal-queries.html';this.page.identifier = 'lc-6223-height-of-binary-tree-after-subtree-removal-queries.html';};(function() {var d = document, s = d.createElement('script');s.src = 'https://dirlt.disqus.com/embed.js';s.setAttribute('data-timestamp', +new Date());(d.head || d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><!-- DISQUS END --></div></body>
</html>
