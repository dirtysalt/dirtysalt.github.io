<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>LC 6103. 从树中删除边的最小分数</title>
<meta name="author" content="dirtysalt" />
<meta name="generator" content="Org Mode" />
<link rel="shortcut icon" href="/themes/favicon.ico" /><link rel="stylesheet" type="text/css" href="/themes/simple.css"/></head>
<body>
<div id="content" class="content">
<h1 class="title">LC 6103. 从树中删除边的最小分数</h1>
<p>
<a href="https://leetcode.cn/contest/weekly-contest-299/problems/minimum-score-after-removals-on-a-tree/">https://leetcode.cn/contest/weekly-contest-299/problems/minimum-score-after-removals-on-a-tree/</a>
</p>

<p>
这题目想了比较长的时间，觉得下面这个解法应该是正确的，大致思路就是枚举删除边。
</p>

<p>
问题就是，如果我们枚举删除边之后在去计算的话，那么时间复杂度肯定是不行的。边的数量在1000左右，枚举2个删除边就是1M的数据量级别，那么计算复杂度就应该是O(1)，否则肯定会超时。
</p>

<p>
假设我们已经创建好了这个联通树，并且计算好了所有的XOR值，记为XOR(t). 我们准备删除 `b-&gt;a` 和 `d-&gt;c` 两条边，大约有下面几种情况
</p>
<ul class="org-ul">
<li>如果b是c的父亲节点的话，那么两个组件是 d 和 `c -&gt; &#x2026; b`. 两个组件的值分别是 `XOR(d)` 和 `XOR(b) ^ XOR(d)`</li>
<li>如果d是a的父亲节点的话，那么两个组件是 b 和 `a -&gt; &#x2026; d`. 两个组件的值分别是 `XOR(b)` 和 `XOR(d) ^ XOR(b)`</li>
<li>两个边是相互独立的话，那么两个组件是 b 和 d, 值分别是 `XOR(b)` 和 `XOR(d)`</li>
</ul>

<p>
有了两个组件，最后的组件就可以通过全值进行异或了。为了快速判断父亲节点，还需要保存每个节点的父节点情况。
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-comment-delimiter">#</span><span class="org-comment">!/usr/bin/env python</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">coding:utf-8</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Copyright (C) dirlt</span>

<span class="org-py-import-from">from</span> typing <span class="org-py-import-from">import</span> List


<span class="org-py-def-class">class</span> <span class="org-py-class-name">TreeNode</span>:
    <span class="org-py-def-class">def</span> <span class="org-function-name">__init__</span>(<span class="org-py-object-reference">self</span>, index, value, depth):
        <span class="org-py-object-reference">self</span>.index = index
        <span class="org-py-object-reference">self</span>.value = value
        <span class="org-py-object-reference">self</span>.total = value
        <span class="org-py-object-reference">self</span>.depth = depth
        <span class="org-py-object-reference">self</span>.parent = <span class="org-py-builtins">set</span>()


<span class="org-py-def-class">class</span> <span class="org-py-class-name">Solution</span>:
    <span class="org-py-def-class">def</span> <span class="org-function-name">minimumScore</span>(<span class="org-py-object-reference">self</span>, nums: List[<span class="org-py-builtins">int</span>], edges: List[List[<span class="org-py-builtins">int</span>]]) -&gt; <span class="org-py-builtins">int</span>:
        <span class="org-py-variable-name">n</span> = <span class="org-py-builtins">len</span>(nums)

        <span class="org-py-variable-name">adj</span> = [[] <span class="org-keyword">for</span> <span class="org-py-builtins">_</span> <span class="org-keyword">in</span> <span class="org-py-builtins">range</span>(n)]
        <span class="org-keyword">for</span> x, y <span class="org-keyword">in</span> edges:
            adj[x].append(y)
            adj[y].append(x)

        <span class="org-py-variable-name">tt</span> = <span class="org-py-number">0</span>
        <span class="org-keyword">for</span> x <span class="org-keyword">in</span> nums:
            <span class="org-py-variable-name">tt</span> ^= x

        <span class="org-py-variable-name">trees</span> = [<span class="org-py-pseudo-keyword">None</span>] * n

        <span class="org-py-def-class">def</span> <span class="org-function-name">build</span>(x, d, pt):
            <span class="org-py-variable-name">t</span> = TreeNode(x, nums[x], d)
            pt.append(x)
            <span class="org-py-variable-name">t.parent</span> = <span class="org-py-builtins">set</span>(pt)
            <span class="org-py-variable-name">trees</span>[x] = t
            <span class="org-keyword">for</span> y <span class="org-keyword">in</span> adj[x]:
                <span class="org-keyword">if</span> trees[y]: <span class="org-keyword">continue</span>
                <span class="org-py-variable-name">t2</span> = build(y, d + <span class="org-py-number">1</span>, pt)
                <span class="org-py-variable-name">t.total</span> ^= t2.total
            pt.pop()

            <span class="org-keyword">return</span> t

        build(<span class="org-py-number">0</span>, <span class="org-py-number">0</span>, [])
        <span class="org-keyword">for</span> xx <span class="org-keyword">in</span> edges:
            xx.sort(<span class="org-py-variable-name">key</span>=<span class="org-keyword">lambda</span> x: trees[x].depth)

        <span class="org-py-variable-name">inf</span> = <span class="org-py-number">1</span> &lt;&lt; <span class="org-py-number">30</span>
        <span class="org-py-variable-name">ans</span> = inf
        <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-py-builtins">range</span>(len(edges)):
            <span class="org-keyword">for</span> j <span class="org-keyword">in</span> <span class="org-py-builtins">range</span>(i + <span class="org-py-number">1</span>, <span class="org-py-builtins">len</span>(edges)):
                <span class="org-py-variable-name">a</span>, <span class="org-py-variable-name">b</span> = edges[i]
                <span class="org-py-variable-name">c</span>, <span class="org-py-variable-name">d</span> = edges[j]
                <span class="org-py-variable-name">ta</span>, <span class="org-py-variable-name">tb</span>, <span class="org-py-variable-name">tc</span>, <span class="org-py-variable-name">td</span> = [trees[x] <span class="org-keyword">for</span> x <span class="org-keyword">in</span> [a, b, c, d]]
                <span class="org-comment"># tb -&gt; ta</span>
                <span class="org-comment"># td -&gt; tc</span>
                <span class="org-keyword">if</span> d <span class="org-keyword">in</span> ta.parent:
                    <span class="org-comment"># tb -&gt; ta -&gt; ...  td -&gt; tc</span>
                    <span class="org-py-variable-name">x</span> = tb.total
                    <span class="org-py-variable-name">y</span> = td.total ^ x
                <span class="org-keyword">elif</span> b <span class="org-keyword">in</span> tc.parent:
                    <span class="org-comment"># td -&gt; tc -&gt; tb -&gt; ta</span>
                    <span class="org-py-variable-name">x</span> = td.total
                    <span class="org-py-variable-name">y</span> = tb.total ^ x
                <span class="org-keyword">else</span>:
                    <span class="org-py-variable-name">x</span> = tb.total
                    <span class="org-py-variable-name">y</span> = td.total
                <span class="org-py-variable-name">z</span> = tt ^ x ^ y
                <span class="org-py-variable-name">minv</span> = <span class="org-py-builtins">min</span>(x, y, z)
                <span class="org-py-variable-name">maxv</span> = <span class="org-py-builtins">max</span>(x, y, z)
                <span class="org-py-variable-name">res</span> = maxv - minv
                <span class="org-py-variable-name">ans</span> = <span class="org-py-builtins">min</span>(res, ans)
        <span class="org-keyword">return</span> ans
</pre>
</div>
</div>
<div id="content"><!-- DISQUS BEGIN --><div id="disqus_thread"></div><script>/***  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/var disqus_config = function () {this.page.url = 'https://dirtysalt.github.io/html/lc-6103-minimum-score-after-removals-on-a-tree.html';this.page.identifier = 'lc-6103-minimum-score-after-removals-on-a-tree.html';};(function() {var d = document, s = d.createElement('script');s.src = 'https://dirlt.disqus.com/embed.js';s.setAttribute('data-timestamp', +new Date());(d.head || d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><!-- DISQUS END --></div></body>
</html>
