# Chapter 1: 戴夫·卡特勒：从运动员到程序员的意外旅程

Grant Seever，来自计算机历史博物馆的采访者，在西雅图贝尔维尤一个阳光明媚的日子里，拜访了戴夫·卡特勒的家，与他展开了一场关于其漫长计算机职业生涯的对话。

戴夫·卡特勒的童年时光在密歇根州的德威特度过，这个小镇距离兰辛（奥兹莫比尔汽车厂所在地）以北约十英里。在德威特高中，他并非典型的书呆子，而是一个耀眼的运动员，在橄榄球、篮球、棒球和田径四个项目中都表现出色，赢得了16个校队荣誉。尽管如此，他的学业成绩也相当不错。作为密歇根州立大学的忠实粉丝，他从小就生活在东兰辛和密歇根州立大学的氛围中。

童年时，戴夫曾对模型飞机充满热情，梦想成为一名飞行员。他投入大量时间制作模型，从简单的到复杂的，甚至尝试制作带动力的模型，尽管它们大多以坠毁告终。这种爱好似乎点燃了他对航空和机械运作的初步兴趣。然而，随着高中时期体育运动的全面展开，他的重心逐渐转向了赛场。

体育天赋为戴夫打开了大学之门。奥利维特学院向他伸出了橄榄枝，提供了一份几乎全额的奖学金，涵盖了学业以及篮球、棒球和橄榄球的费用。对于当时家境并不富裕的戴夫来说，这无疑是上大学的唯一途径。尽管他曾心仪中央密歇根大学，但未能被录取，最终选择了离家不远的奥利维特学院。

刚进入大学时，戴夫对未来感到迷茫，像许多新生一样，不确定自己真正想学什么。最终，他被数学的挑战性和趣味性所吸引，将其定为主修。自然而然地，他又辅修了大量物理课程，并深深爱上了这两个学科。奥利维特学院作为一所文理学院，且带有宗教背景，戴夫不得不修习许多他并不感兴趣的通识和宗教相关课程，但他始终将重心放在了数学和物理上。

大学前两年，戴夫的生活重心是体育，学业上只求勉强过关，以保住奖学金。然而，命运的转折点不期而至。在短短18个月内，他经历了右膝手术（切除了内侧半月板）、左腿骨折，以及左膝手术（同样切除了内侧半月板）。这些伤病彻底终结了他的体育生涯。

从那时起，戴夫意识到自己不能永远依靠体育。他开始认真思考未来，发现自己真正喜欢的是数学和物理，并且是一个喜欢动手建造东西的人。于是，他将目标锁定在工程领域，尽管他没有工程学学位。在那个年代（1965年），拥有数学学位的人仍有可能进入工程领域，这在今天看来或许有些不可思议。

1965年毕业时，公司并不会主动到奥利维特这样的小型文理学院招聘。戴夫主动向多家公司投递了简历，包括洛克希德、通用汽车、杜邦等航空航天和工业巨头。最终，他收到了三份正式工作邀请：一份来自克莱斯勒的软装饰工厂，从事运营研究和时间研究；一份来自奥兹莫比尔的计算机会计部门；以及一份来自杜邦，据称是工程职位。

戴夫毫不犹豫地拒绝了奥兹莫比尔的邀请，因为他不想从事会计工作。在当时，公众对计算机的普遍认知就是用于记录和会计，IBM的机器也大多用于此。他对这种“文书”工作毫无兴趣。最终，他选择了杜邦公司在特拉华州威尔明顿的职位，满心期待地以为那是一份工程工作。

然而，现实给了他一记重击。这份工作与他预期的“工程”相去甚远，他被分配到杜邦弹性体材料部门，成为一名技术撰稿人，负责编写合成橡胶（如氯丁橡胶，用于潜水服和轮胎）的标准测试方法，指导如何拉伸、弯曲和测试这些材料。这与计算机领域简直是天壤之别，也让他深刻体会到面试时务必“刨根问底”的重要性。

在杜邦的销售服务实验室工作了一年左右，戴夫感到极度无聊。幸运的是，实验室里有一个数学与统计小组，他曾与他们面试过。这个小组向他抛出了橄榄枝，希望他能暂时借调过去，为斯科特纸业公司开发一个泡沫生产过程的模型。斯科特纸业正在开发一种用于服装行业的新型泡沫，而杜邦的数学与统计小组经理希望通过模型来优化生产调度。

戴夫欣然接受了这个机会，因为这比枯燥的技术写作有趣多了。杜邦将他送往IBM学校，学习一种名为GPS III（通用系统模拟器3）的语言。GPS III是一种事件驱动、块导向的语言，通过“创建事务”等模块来模拟实时并行系统，且无需处理复杂的同步问题。

在构建这个相当庞大的模型过程中，戴夫的兴趣逐渐从模型本身转向了计算机的内部运作原理。他开始深入研究计算机架构，特别是他们使用的IBM 7044（一台36位机器，是7094的前身）。

这次经历也让他学到了宝贵的一课：人类是多么容易犯错，而计算机只会严格执行你所说的，而非你所想的。他至今仍记得第一次去费城IBM数据中心的经历。带着2000张打孔卡，与IBM代表和老板一同前往，满怀信心地准备运行模型。然而，他们花了整整一天的时间，却连程序中的语法错误都未能完全清除。这次挫折让他对编程和计算机的严谨性有了深刻的认识，也培养了他日后的谦逊。

# Chapter 2: 代码的洗礼：戴夫·卡特勒的操作系统启蒙与职业转折

戴夫·卡特勒在杜邦公司首次接触编程，便遭遇了一次刻骨铭心的“羞辱”。他带着精心准备的2000张打孔卡，满怀信心地前往费城的IBM数据中心，准备运行他的GPS模型。然而，现实却给了他当头一棒。整整一天，他和同事们都在徒劳地试图从程序中清除语法错误，最终一无所获。这次经历让他深刻认识到人类的易错性，以及计算机的冷酷无情——它们只会精确执行指令，而不会理解你的意图。这无疑是一次谦卑的教训。

尽管开局不顺，GPS项目最终还是成功了。这个项目持续了大约一年，戴夫与来自斯科特纸业公司的一位同样年轻、经验不足的同事合作。他们定期前往数据中心，输入信息，获取结果。他们的目标是为一台生产泡沫的机器找出最佳的排产方案，以最大化不同颜色和纹理泡沫的生产效率。最终，模型成功运行，他们向斯科特纸业提交了成果，并进行了隆重的演示。虽然戴夫怀疑斯科特纸业后续并未充分利用这个模型，但他明白，这在很大程度上是杜邦公司为了展示其对斯科特纸业的支持，进行的一次公关活动。这次经历让戴夫对计算机的实际应用有了更深的理解。

GPS项目结束后，戴夫对计算机的兴趣日益浓厚。他决定留在数学与统计组，继续探索这个迷人的领域。在那里，他开始接触更复杂的系统，比如位于实验站的UNIVAC 1107（后来升级为1108）机器。他通过班车提交程序，获取结果，逐渐熟悉了大型机的操作。此外，他还参与了采购一台CDC 1700型16位机器的项目，旨在自动化实验室中的Instron拉伸强度测试机。这些经历让他对计算机硬件和软件的结合产生了浓厚兴趣。

大约两年后，戴夫意识到自己真正想做的，是深入研究计算机本身，而不是仅仅将它们作为解决其他问题的工具。于是，他成功争取调到了杜邦公司的工程部门。这个部门拥有强大的计算能力，并且拥有那台UNIVAC 1107（已升级为1108）。他加入了在线系统组，这个小组的主要职责是协助公司内部的各个运营部门解决计算机过程控制的需求。

然而，在线系统组的工作并非总是繁忙。由于项目导向，经常会有空闲时间。戴夫利用这些时间，主动找到系统编程组，询问是否有可以帮忙的地方。他们交给他一项艰巨的任务：找出UNIVAC 1108上臭名昭著的操作系统EXEC 2频繁崩溃的原因。每当系统崩溃，就会生成一份长达四英寸的折叠纸打印输出，也就是所谓的“内存转储”（dump）。戴夫的工作就是分析这些堆积如山的转储文件，有时甚至高达六英尺，试图找出崩溃的模式和原因。这是一场真正的“火的洗礼”。他不得不深入理解系统的工作原理，才能找出它为何不工作。他追踪代码，有时回溯上千条指令，直到线索突然中断。

后来，戴夫在微软工作时，得知华盛顿大学圣路易斯分校的一项研究揭示了1108系统每隔四小时就会进入亚稳态，原因是系统中的同步器未能正确同步所有时钟。这终于解释了EXEC 2为何如此不稳定。尽管如此，戴夫在杜邦期间通过分析转储文件，也发现并修复了许多由杜邦自身对EXEC 2进行的约2000行修改所引入的问题。随着时间的推移，戴夫的努力赢得了同事的信任，他逐渐成为1108系统主要维护者之一，负责进行改进并加入杜邦特有的优化。这段经历让他对操作系统有了深刻的理解，并坚定了他在这个方向上发展的决心。

后来，在线系统组接到了一个大项目：为杜邦的主要研究中心——占地120英亩的实验站自动化仪器数据分析。戴夫参与了供应商评估，最终选择了DEC的PDP-10系统。他们采购了一套带有共享内存的双PDP-10系统，并为其中一台（作为前端）编写了一个操作系统，用于数据采集。数据完成后，通过共享内存提交给另一台运行TOPS-10系统的PDP-10进行Fortran程序分析，并将结果返回。戴夫因此获得了丰富的DEC PDP-10经验，甚至参加了由戴夫·普拉默（DEC的TOPS-10专家）主讲的TOPS-10课程。

紧接着，他又被分配了一个使用DEC设备的任务：为用于磁带的Cronar胶片开发PDP-11测厚仪控制系统。由于当时没有合适的操作系统能满足小型PDP-11（可能只有8K内存）的需求，戴夫承担了开发一个小型实时运行系统的任务。

完成这个项目后，戴夫意识到，虽然他在杜邦公司深入参与了计算机工作，但他仍然是在一家非计算机公司里使用计算机。为了最大化自己的价值，并在操作系统领域深耕，他决定去一家真正制造计算机的公司。他安排了与马萨诸塞州梅纳德的Digital Equipment Corporation（DEC）的面试，并成功被录用。

戴夫在杜邦工作了七年。他回忆说，杜邦的文化对他来说非常陌生。这是一家成立于19世纪中叶的老牌公司，曾在美国内战期间供应黑火药，因此非常官僚和刻板。等级森严，下属通常不会直接与上司的上司交流。尽管杜邦为他的职业生涯提供了宝贵的经验，但他感觉在那里并不像后来在DEC那样自在。

戴夫对DEC的文化一无所知，但他更看重机会。他被DEC聘用，负责一个名为OS/45的项目。这是DEC编程主管戴夫·斯通的一个宏伟构想：在PDP-10/45（一款配备300纳秒固态内存的超高速机器）上，重新构建TOPS-10，并融入实时和批处理能力。戴夫的直属上司是彼得·范·罗金，他曾是RCA公司VOS（虚拟内存操作系统）的开发者。戴夫即将开启他在计算机公司里，真正专注于操作系统开发的新篇章。

# Chapter 3: OS/45的挫折、RSX-11M的辉煌与VAX的序章

1971年，戴夫·卡特勒满怀憧憬地加入了DEC，投身于OS/45项目。这个项目由戴夫·斯通主导，他有一个宏伟的愿景：在PDP-11/45这台拥有300纳秒内存、性能卓越的机器上，重现PDP-10的TOPS-10操作系统，并融入实时处理和批处理能力，以补充分时功能。项目团队约有八人，由彼得·范·罗金领导，他曾是RCA公司VMOS虚拟内存操作系统的开发者。

然而，最初的几个月，团队的进展却异常缓慢。一个被戴夫·斯通低估的致命问题浮出水面：PDP-11的地址空间仅有65KB，且内存管理能力也差强人意。这对于一个雄心勃勃的操作系统来说，简直是杯水车薪，OS/45项目因此陷入了僵局。

面对困境，卡特勒被调往工业产品部门，参与一个名为RSX-1C的实时过程控制操作系统项目。这是他在DEC真正意义上的第一个“实战”项目。RSX-1C是一个核心驻留系统，功能相对简单，仅支持少数外设。随着PDP-11系列机器（如11/40、11/45、11/70）的不断丰富，市场对功能更强大、编程能力更强的操作系统需求日益迫切。

RSX系列操作系统应运而生，从最初的RSX-1C，到能从磁盘加载DOS-11文件的RSX-1B，再到与18位RSX-15系统对标的RSX-11D。卡特勒在RSX-11D项目中负责开发覆盖链接器，但这个系统最终却比预期更大、更慢。他发现，RSX-11D的架构设计存在根本性缺陷——所有组件都作为独立进程运行，包括驱动程序，这意味着程序与驱动之间需要复杂的进程间通信（IPC），严重影响了实时性能。

卡特勒深知必须另辟蹊径。他提出了一种全新架构的系统——RSX-11M。工业产品部门对他的想法非常兴奋，并拨给他一个约八人的团队。在卡特勒的带领下，团队仅用一年半到两年时间就完成了RSX-11M的开发。这不仅是卡特勒首次独立领导一个大型操作系统项目，也标志着他职业生涯的一个重要里程碑。RSX-11M能够运行在所有PDP-11系列机器上，从32KB内存到2MB内存的系统，成为PDP-11系列的主流实时操作系统。

在RSX-11M的开发过程中，卡特勒确立了“质量第一”的哲学，并将其贯彻始终。面对有限的内存资源，他创新性地为每个模块设定了严格的内存预算，并制作了印有“大小是目标”（Size is the Goal）字样的橡皮图章，盖在每一份内部备忘录上，以此强调对内存占用的控制。最终，在一个32KB的系统中，操作系统本身仅占用16KB，为用户应用留下了充足空间。RSX-11M是一个专用的实时控制系统，而非通用系统，它为购买者提供了编写控制软件的平台。

卡特勒以其亲力亲为的领导风格而闻名，他认为自己是团队的“领导者而非管理者”，乐于深入代码，解决问题，甚至修复他人的错误。他坚信“成功者做那些不成功者不愿做的事”，这种精神贯穿了他整个职业生涯。

大约在1975年，DEC意识到需要开发32位计算机，以应对市场竞争。凭借在RSX-11M项目中的卓越表现，卡特勒自然而然地参与了这一被称为“VAX”（Virtual Address eXtension，虚拟地址扩展）的新项目。在戈登·贝尔的领导下，VAX项目设立了多个架构小组，卡特勒作为VAX-B（评审组）的正式成员和VAX-A（硬件架构组）的非正式成员，与戈登·贝尔等人频繁会面，共同探讨计算机架构和指令集设计。VAX的目标是实现高指令密度，使程序在与PDP-11相同的内存空间内编码，并大幅扩展虚拟地址空间至32位。然而，当公司要求在两年内完成VAX的开发时，团队意识到现有架构过于复杂。为此，一个由软硬件专家组成的“蓝丝带委员会”成立，通过一次为期一周的场外会议，最终简化了VAX的架构，使其在两年内完成成为可能。

# Chapter 4: VAX架构与VMS的诞生：卡特勒的抉择与“吃狗粮”哲学

在DEC公司，戴夫·卡特勒（Dave Cutler）与他的团队正面临着一项艰巨的任务：在短短两年内，完成VAX架构的构建。当被问及需要多长时间时，他们被告知“两年似乎合理”，这让卡特勒惊呼：“天哪，我们绝不可能在两年内完成！这个架构太复杂了！”

为了应对这一挑战，他们举行了一次为期一周的“蓝丝带委员会”会议，这是一场“来见耶稣”式的关键会议。委员会由三名软件开发人员、三名软件实现者、三名硬件实现者以及一些架构师组成。他们夜以继日地工作，最终敲定了VAX的最终架构。这次会议极大地简化了指令集架构的复杂性，尽管卡特勒承认，即使简化后，人们可能仍会觉得它过于复杂，但与之前相比，它已经大大改善了。

另一个被简化的是内存管理系统。最初的内存管理复杂到只有里奇·拉里（Richie Larry）一人能完全解释清楚，其他人则是一头雾水，不确定它是否能真正奏效。经过简化，硬件架构师们认为他们可以高效地实现它，而软件开发人员也相信他们能为其构建操作系统。

然而，在VAX的设计中，也埋下了两个长期来看的“错误”。一是指令流的编码方式与PDP-11类似，这使得主要由硬件而非微代码实现的系统变得极其难以构建。结果，VAX指令集大部分通过微代码执行，而非直接由硬件执行，因为解码实在太困难了。另一个“错误”是页面大小被设定为512字节，而非更合理的1K或4K字节。这个决策是出于市场营销的考虑，因为营销团队希望销售内存大小与PDP-11系统相当的VAX系统，即128K字节。考虑到VAX架构中最复杂的指令——一个带有六个操作数的打包十进制指令（ADDP6）可能触及40个页面，如果内存只有128K字节，512字节的页面大小是为了避免系统陷入“活锁”状态，即无法将所有必需的页面加载进来执行指令。

VAX架构最终敲定后，卡特勒领导的软件团队和硬件团队正式组建。作为软件团队的技术负责人，卡特勒和他的团队花了大约六个月的时间，深入思考如何构建这个系统。他们对构建分页系统充满了恐惧，因为当时分页系统的经验非常有限。PDP-10没有分页，只有交换；BBN对PDP-10的修改虽然引入了分页，但传闻运行不佳；Multics虽然是分页系统，但运行缓慢，效率低下。因此，他们投入了大量精力研究如何设计一个既能保证良好性能，又能按时完成，并达到预期质量的系统。

六个月后，他们撰写了名为“Starlet设计与项目计划”的文档，并以此为蓝图开始了VMS的开发。VMS主要是在RSX-11M系统上开发的，当时RSX-11M已经具备了一些分时能力。他们在一台拥有2兆字节内存的PDP-11/70上进行开发，并通过硬件模拟器运行VMS。当VAX-11/780的实验电路板（breadboard）可用时，他们将已有的代码移植上去，系统成功启动，至少达到了不会崩溃的程度。

随后，他们使用了一个名为“Proto 4”的原型机作为开发平台，所有开发人员都在这台机器上工作。这正是“吃狗粮”（dogfooding）理念的首次实践——开发人员在自己开发的系统上工作。这种做法极大地激励了他们去修复任何问题。每当系统崩溃时，卡特勒、迪克·休塞特（Dick Husett）和彼得·利特曼（Peter Litman）就会立刻冲出去，找出崩溃原因，修复问题，然后重新启动一个新系统供大家使用。正是这种亲力亲为、快速迭代的开发模式，使得VMS在发布当天实现了“零已知bug”——尽管这不代表没有bug，但所有已知问题都已解决，甚至在最后一刻还修复了一个竞争条件问题。

VMS和VAX-11/780的成功发布，将DEC推向了超级迷你计算机时代，开启了更大的应用领域，并逐渐进入商业市场，带来了大量新功能和需求，也促使VMS不断演进。

然而，VMS版本1发布后，卡特勒并没有继续参与后续版本的开发。他认为VMS是他第一个“非常困难”的项目，两年内完成如此高水平的系统，时间异常紧张。他开始思考尝试其他感兴趣的领域，其中之一就是编译器。于是，他决定组建一个编译器团队，开发PL/1编译器。这个团队最初只有四人，后来发展到六人。他们从波士顿一家公司购买了编译器的前端，然后自己开发了后端（代码生成器）。这个项目也持续了大约两年，并在此过程中催生了VAX的C编译器。

在PL/1编译器的开发过程中，他们再次实践了“吃狗粮”的理念。编译器的前端是在Multics系统上交付的。最初，他们尝试在Multics上编译部分代码，然后传输到VAX上运行。但由于网络连接（300波特率）太慢，无法实现全双工传输，半双工也效果不佳。最终，他们雇佣了穿梭服务：前端开发人员在Multics上生成代码，存入磁带，然后由穿梭服务运到DEC，再从磁带读取。他们采取了“逆向引导”的方式：先用汇编语言编写代码生成器，使其工作，然后逐步将编译器的各个阶段从Multics移植过来，直到整个编译器都能在DEC内部编译运行。除了代码生成器中必须在最后运行的部分，整个编译器都是用PL/1编写的，这再次证明了他们对“吃狗粮”的坚持。

时间来到了1981年左右，卡特勒开始对DEC的快速扩张感到厌倦。他刚加入DEC时，公司只有1.2万人，而到1981年，员工人数已飙升至7.5万人。曾经以工程为主导的环境，逐渐演变为一个由管理和市场营销主导的官僚机构，这让他感到非常不满。他向戈登·贝尔（Gordon Bell）表达了想去其他地方的愿望。贝尔甚至提出，如果他想去哪里，DEC可以考虑在那里建立一个工程设施。

正当卡特勒犹豫不决时，一个机会出现了：一家新公司计划将政府资助的实时控制语言Praxis（为劳伦斯利弗莫尔实验室的Shiva Nova聚变能源项目开发）商业化。卡特勒对此充满热情，于是他与另外五人（四名来自DEC，两名来自劳伦斯利弗莫尔）开始在湾区寻找资金。然而，他很快意识到这可能不是正确的选择。公司的总裁似乎更关心如何挥霍他们的启动资金（他们自己投入的），比如用公司的钱支付他妻子的工资来制作文具。眼看所有资金都被挥霍一空，卡特勒在最后一刻决定退出。其他DEC的同事也随之退出。

这让卡特勒再次面临去留问题。他告诉戈登·贝尔，他想去一个更小、更独立、官僚主义较少的环境。贝尔表示赞同，并问他想去哪里。卡特勒说不能在东海岸，因为不够远；他也不太喜欢西南部（亚利桑那、新墨西哥），德克萨斯可能也不合适，所以西海岸是最好的选择。贝尔同意了西海岸的提议，但提出了一个条件：他希望卡特勒去一个拥有优秀计算机科学项目的大学附近。

# Chapter 5: 西海岸的召唤：DEC西部实验室的崛起

戴夫·卡特勒的心中，对DEC东海岸总部那日益膨胀的官僚体系和庞杂环境感到厌倦。他渴望一个更小、更专注、更“与世隔绝”的工程环境，一个能让他摆脱繁文缛节、纯粹投入技术创造的地方。当他向戈登·贝尔表达这一愿望时，贝尔出人意料地表示支持，并问道：“你想去哪里？”

卡特勒明确表示，东海岸不够远，西南地区（如亚利桑那、新墨西哥、德克萨斯）也不太合心意，他认为西海岸是最佳选择。戈登·贝尔对此表示赞同，但提出了一个条件：新地点必须靠近一所拥有优秀计算机科学项目的大学，以便吸引人才并进行合作。于是，DEC的房地产部门精心安排了一次西海岸考察之旅，目的地包括旧金山、萨克拉门托、圣罗莎、波特兰和西雅图。

在这次考察之前，卡特勒曾有过一段有趣的插曲。他曾前往波特兰面试英特尔，当时英特尔正在开发其32位计算机432项目。这次面试并非为了跳槽，而是为了“摸清自己的市场价值”。当英特尔准备发出录用通知时，却要求他必须先告知戈登·贝尔，因为两家公司合作紧密。卡特勒毫不犹豫地照办了，他打电话给贝尔，坦诚自己只是想知道自己值多少钱。十五分钟后，贝尔和拉里·帕特纳斯就出现在他面前，共进午餐。在这次午餐中，卡特勒再次表达了对波特兰的喜爱，贝尔也因此萌生了为他在那里建立工程中心的想法，并提高了他的薪资和股票期权。然而，卡特勒当时并未接受，直到后来他尝试的另一家公司机会落空，他才真正下定决心要搬离东海岸。

回到西海岸的考察之旅，当他们抵达西雅图时，尽管天空中飘着细雨，但满眼的翠绿却让卡特勒心生好感。他们拜访了华盛顿大学，与计算机科学系主任进行了深入交流，对方对DEC的到来表现出浓厚兴趣。最终，经过深思熟虑，卡特勒和团队一致认为西雅图（以及附近的贝尔维尤）是理想之地，这里既有大学的学术氛围，又不像旧金山湾区那样过于喧嚣。

就这样，DEC西部实验室在西雅图成立了。卡特勒带来了大约八名东海岸的同事，并积极从华盛顿大学等本地机构招聘人才，以加强与大学的联系。他们的首个任务是开发VAX Salon，一个针对嵌入式芯片VAX系统（代号“天蝎座”Scorpio）的实时操作系统。这个系统是他们首次涉足多线程技术，与卡内基梅隆大学的Mach项目几乎同时进行。

然而，“天蝎座”芯片的开发进度缓慢，缺乏合适的运行平台。于是，团队开始思考如何精简VAX架构，催生了“MicroVAX”项目。最初，他们只打算精简架构，但很快意识到需要自己的硬件平台。因此，DEC西部实验室又成立了硬件团队，着手开发MicroVAX I，一个小型系统，而非单芯片。卡特勒本人也从VAX Salon的内核开发转向了MicroVAX I的微代码编写，对硬件产生了浓厚兴趣。

在MicroVAX I的开发过程中，他们与加州理工学院的卡弗·米德（Carver Mead）和林恩·康威（Lynn Conway）倡导的“硅编译器”技术合作，旨在设计一个单芯片的中央处理器。然而，芯片制造过程一波三折。最初的供应商AMI公司竟然将所有掩膜都做反了，导致芯片完全无法使用。最终，他们转向了SEEQ公司，才成功生产出功能正常的芯片。

在MicroVAX架构讨论的后期，为了精简，VAX的内存管理功能被大幅削减，这意味着VMS操作系统将无法直接运行。但卡特勒在编写微代码时意识到，实现完整的内存管理所需的微代码量并不多，反而能让VMS运行，从而大大减少了整体工作量。在他的坚持下，并说服了负责微代码的鲍勃·萨特尼克，他们决定在MicroVAX I中实现完整的内存管理。这一决策至关重要，使得VMS几乎与VAX Salon同时在MicroVAX I上成功运行，这在当时（大约1984年）是一个巨大的成就。

DEC西部实验室的初期项目取得了巨大成功，以极低的开销、少量的人员，在创纪录的时间内完成了任务。然而，随之而来的却是新的挑战：如何找到不与总部其他团队重复的项目。他们提出了多个硬件和系统构建方案，但屡次被总部否决，陷入了寻找“正确VAX”的困境。正是在这个时期，RISC（精简指令集计算机）架构开始流行，并被认为在性能上超越了VAX。公司内部多个RISC项目并行，最终，工程高级副总裁杰克·史密斯决定，将DEC的RISC架构开发任务——“棱镜”（PRISM）项目，全权交由DEC西部实验室负责。这标志着DEC西部实验室进入了一个全新的时代，也预示着一场公司内部的RISC架构之战即将打响。

# Chapter 6: PRISM的终结与戴夫·卡特勒的微软新篇章

在DEC西部实验室，戴夫·卡特勒的团队曾以惊人的速度和极低的非经常性工程成本（NRE）完成了多个项目，创造了公司内部的记录。然而，在VAX Salon和MicroVAX I的辉煌之后，他们却陷入了一段迷茫期，难以找到下一个合适的项目。直到公司内部一场激烈的“RISC架构之战”爆发，才为他们指明了方向。

当时，DEC公司内部多个团队都在各自开发RISC项目，导致资源分散，效率低下。为了整合力量，PRISM（并行RISC指令集机器）架构的重任最终落到了DEC西部实验室肩上。卡特勒回忆道，PRISM架构委员会的组成颇为复杂，汇集了来自VMS操作系统、哈德逊半导体部门、马尔伯勒工厂以及公司架构组的代表，当然也包括他自己。接下来的近三年时间里，他们陷入了无休止的争论和修改，架构在32位和64位之间反复横跳，耗费了大量精力。

更糟糕的是，PRISM项目逐渐偏离了RISC架构“易于实现”的初衷。为了与超级计算机Cray竞争，公司高层要求加入向量运算功能。Cray可能只有八条向量指令，而PRISM却被要求拥有多达150条，而且必须是长向量，这使得架构变得异常复杂，与RISC的简洁理念背道而驰。尽管如此，DEC西部实验室仍在积极准备，甚至将MicroVAX I改造为能运行PRISM代码的平台，以便软件开发人员能提前介入。

然而，这场漫长的拉锯战最终以悲剧收场。PRISM项目被公司突然叫停，DEC西部实验室正在开发的PRISM机器和配套的Micah操作系统也随之取消。卡特勒对此感到极度沮丧，他曾试图在公司内部寻求共识，但每次回到西雅图，项目总是变得更加庞大和模糊。团队规模从最初的20人膨胀到180人，却在为一个“模糊不清”的产品努力。眼见公司在马尔伯勒、利特尔顿和西雅图三地同时推进类似项目，最终却一无所获，卡特勒心灰意冷。

他决定不再重蹈覆辙，而是选择离开DEC，与三位志同道合的同事共同创业。他们的计划是成立一家公司，专注于构建服务器，并打算在服务器上运行Unix（具体是Mach系统），因为开发自己的操作系统耗时太长且兼容性差。1988年，他们成功获得了三家风险投资公司（包括MIPS的VC）共计100万美元的种子资金，这在当时是一笔不小的数目。

就在他们即将大展拳脚之际，一个意想不到的机会出现了。一位前DEC员工跳槽到微软后，向比尔·盖茨提到了卡特勒团队在操作系统方面的卓越能力。微软当时正面临Intel x86架构发展缓慢的困境，担心RISC处理器会超越x86，从而导致其PC软件失去价值。因此，微软急需一个用可移植语言编写的、能在多种RISC架构上运行的新操作系统。

卡特勒最初对微软的提议并不感兴趣，他更倾向于经营自己的公司。然而，在获得风投承诺后，这些投资人却开始质疑他们管理公司和开发产品的能力，这让卡特勒感到有些不快。就在此时，微软的财务主管史蒂夫·鲍尔默打来电话。当卡特勒表示可能要拒绝微软的邀请时，鲍尔默立刻邀请他们四人共进早餐。在一个周六（或周日）的清晨，他们在丹尼餐厅见面。鲍尔默以其惊人的活力和积极的思维，成功地说服了卡特勒团队。他们最终放弃了创业计划，决定加入微软。

卡特勒立即辞职，周一便加入了微软，而他的三位核心同事也紧随其后。随后，他们又吸引了许多DEC西部实验室的顶尖硬件和软件工程师加入。卡特勒还成功说服微软，允许他同时拥有硬件和软件团队，硬件团队将负责开发微软第一款基于RISC的PC，而软件团队则为之开发操作系统。

在微软，卡特勒看到了与DEC截然不同的文化。他怀念DEC早期以工程师为主导的时代，那时工程师们提出产品、与客户交流、追求高质量。而微软则是一家高度市场导向的公司，他们擅长将DOS等PC软件推销给IBM。卡特勒对此喜忧参半：他喜欢有强大的市场团队来推广产品，但也担心市场部门会过多干预工程决策。

最终，Windows NT的最初版本在很大程度上仍是工程驱动的，但微软的市场需求也对其产生了深远影响。除了可移植性，微软还要求NT兼容多种操作系统环境，以满足市场需求。因此，NT被设计成具有多重“子系统个性”，需要兼容OS/2、DOS，甚至流行的POSIX（Unix标准化接口）。尽管如此，NT的设计过程比VMS更加详细和规范，为未来的成功奠定了基础。

# Chapter 7: NT的诞生：五年磨一剑的操作系统传奇

戴夫·卡特勒和他的团队在微软开启了Windows NT的宏伟篇章。他们吸取了VMS项目的经验，决定为NT制定一份前所未有的详尽规范，这份“巨型规格书”耗时半年多才完成，旨在让任何新加入的工程师都能迅速理解系统架构。最初，他们乐观地预计两年内就能交付操作系统，但现实远比想象复杂，最终耗时五年才完成首个版本。

这漫长的五年并非没有缘由。VMS没有图形用户界面，而NT必须从零开始构建一个。更棘手的是，NT被赋予了运行多种“人格”的重任，不仅要兼容OS/2、DOS和POSIX，还要面对不断变化的硬件平台。最初，微软选择了英特尔的i860处理器作为首个RISC PC的参考实现平台，甚至与意大利的Olivetti公司合作生产。然而，i860很快被发现“病得很重”，存在大量错误（errata），尤其是在操作系统层面表现不佳，其虚拟标签缓存机制在上下文切换时效率低下，使其几乎无法用于操作系统开发。仅仅一年后，团队不得不放弃i860，转投MIPS的R4000处理器。

然而，平台切换的挑战才刚刚开始。DEC得知微软的动向后，也希望NT能支持他们的R3000工作站。卡特勒团队“愚蠢地”同意了，却发现R3000与R4000并不完全兼容，这使得他们不得不为两个MIPS平台进行开发。紧接着，英特尔的386处理器也加入了战局，由于x86平台已有成熟的硬件生态，微软无需自行开发硬件。随后，DEC的Alpha处理器和IBM的PowerPC也相继被纳入支持列表，使得NT最终要同时支持多达四到五个不同的硬件平台。

雪上加霜的是，在90年代初，Windows 3.1的巨大成功（六个月内售出1600万份）让比尔·盖茨意识到，Windows而非OS/2将成为微软未来的主要操作系统环境。这一决策意味着NT必须从原先以OS/2为中心的设计，转向全面兼容Windows，包括16位DOS模拟器、16位Windows模拟器，以及在Alpha、PowerPC和MIPS上运行的32位Windows模拟器。所有这些兼容性要求，无疑让NT的开发复杂性呈几何级数增长。

除了技术挑战，卡特勒团队还面临着文化上的冲突。DEC是一家以工程为导向、追求卓越工程的公司，而微软在当时则更偏向市场驱动。卡特勒认为，微软缺乏DEC那样的软件工程纪律，因此他致力于将这种严谨的工程文化引入微软。这导致了与微软项目经理的初期摩擦，卡特勒甚至写了一封长邮件，明确划分了自己作为工程负责人与项目经理的职责范围，最终确保了工程团队的自主权。尽管如此，微软的文化背景仍使得项目周期被拉长，许多事情超出了工程团队的控制范围。

在如此巨大的压力下，卡特勒以其独特的领导风格维系着团队。他始终将自己视为团队的一员，而非高高在上的管理者，与团队同甘共苦。这种领导方式使得团队的流失率极低，尽管五年高强度的工作让一些人付出了个人生活的代价（例如离婚），但大家对产品都抱有坚定的信念。为了缓解压力和增进团队凝聚力，网络组的戴夫·汤普森提议每周五晚上举行“每周集成会议”（Whim），最初只是简单的啤酒、披萨和薯片，后来发展成为由万豪酒店提供全套餐饮、虾和啤酒桶的盛大聚会。这些聚会不仅让团队成员相互了解，也成为了他们释放压力、保持士气的关键。团队规模也从最初的25人，增长到Windows NT 1.0发布时的150人，到4.0版本时达到400人，如今更是发展到4000人的庞大组织。正是这种坚韧不拔的精神和独特的团队文化，最终让Windows NT这个复杂而雄心勃勃的操作系统得以面世。

